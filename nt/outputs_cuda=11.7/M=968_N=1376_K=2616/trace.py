# from tvm import tir
def apply_trace(sch: tir.Schedule) -> None:
  b0 = sch.get_block(name="Y", func_name="main")
  b1 = sch.cache_write(block=b0, write_buffer_index=0, storage_scope="local")
  b2 = sch.cache_read(block=b0, read_buffer_index=0, storage_scope="shared.dyn")
  b3 = sch.cache_read(block=b0, read_buffer_index=0, storage_scope="local")
  b4 = sch.cache_read(block=b0, read_buffer_index=1, storage_scope="shared.dyn")
  b5 = sch.cache_read(block=b0, read_buffer_index=1, storage_scope="local")
  l6, l7, l8 = sch.get_loops(block=b0)
  v9, v10, v11 = sch.sample_perfect_tile(loop=l6, n=3, max_innermost_factor=16, decision=[11, 8, 11])
  v12, v13, v14 = sch.sample_perfect_tile(loop=l7, n=3, max_innermost_factor=16, decision=[43, 4, 8])
  v15, v16 = sch.sample_perfect_tile(loop=l8, n=2, max_innermost_factor=8, decision=[654, 4])
  l17, l18, l19 = sch.split(loop=l6, factors=[v9, v10, v11], preserve_unit_iters=True)
  l20, l21, l22 = sch.split(loop=l7, factors=[v12, v13, v14], preserve_unit_iters=True)
  l23, l24 = sch.split(loop=l8, factors=[v15, v16], preserve_unit_iters=True)
  sch.reorder(l17, l20, l18, l21, l22, l19)
  l25 = sch.fuse(l17, l20, preserve_unit_iters=True)
  sch.bind(loop=l25, thread_axis="blockIdx.x")
  v26, v27, v28 = sch.sample_perfect_tile(loop=l18, n=3, max_innermost_factor=16, decision=[8, 1, 1])
  v29, v30 = sch.sample_perfect_tile(loop=l21, n=2, max_innermost_factor=16, decision=[4, 1])
  l31, l32, l33 = sch.split(loop=l18, factors=[v26, v27, v28], preserve_unit_iters=True)
  l34, l35 = sch.split(loop=l21, factors=[v29, v30], preserve_unit_iters=True)
  sch.reorder(l25, l34, l31, l32, l35, l33, l23, l24, l22, l19)
  l36 = sch.fuse(l34, l31, preserve_unit_iters=True)
  l37 = sch.fuse(l32, l35, l33, preserve_unit_iters=True)
  l38 = sch.fuse(l36, l37, preserve_unit_iters=True)
  sch.bind(loop=l38, thread_axis="threadIdx.x")
  sch.compute_at(block=b3, loop=l24, preserve_unit_loops=True, index=-1)
  sch.compute_at(block=b5, loop=l24, preserve_unit_loops=True, index=-1)
  sch.compute_at(block=b2, loop=l23, preserve_unit_loops=True, index=-1)
  sch.compute_at(block=b4, loop=l23, preserve_unit_loops=True, index=-1)
  l39, l40, l41, l42, l43, l44 = sch.get_loops(block=b3)
  v45, v46 = sch.sample_perfect_tile(loop=l44, n=2, max_innermost_factor=16, decision=[11, 1])
  l47, l48 = sch.split(loop=l44, factors=[v45, v46], preserve_unit_iters=True)
  sch.vectorize(loop=l48)
  l49, l50, l51, l52, l53, l54 = sch.get_loops(block=b5)
  v55, v56 = sch.sample_perfect_tile(loop=l54, n=2, max_innermost_factor=16, decision=[8, 1])
  l57, l58 = sch.split(loop=l54, factors=[v55, v56], preserve_unit_iters=True)
  sch.vectorize(loop=l58)
  l59, l60, l61, l62, l63 = sch.get_loops(block=b2)
  l64 = sch.fuse(l62, l63, preserve_unit_iters=True)
  l65, l66, l67 = sch.split(loop=l64, factors=[v10, v13, None], preserve_unit_iters=True)
  l68 = sch.fuse(l65, l66, preserve_unit_iters=True)
  sch.bind(loop=l68, thread_axis="threadIdx.x")
  l69, l70, l71, l72, l73 = sch.get_loops(block=b4)
  l74 = sch.fuse(l72, l73, preserve_unit_iters=True)
  l75, l76, l77 = sch.split(loop=l74, factors=[v10, v13, None], preserve_unit_iters=True)
  l78 = sch.fuse(l75, l76, preserve_unit_iters=True)
  sch.bind(loop=l78, thread_axis="threadIdx.x")
  sch.reverse_compute_at(block=b1, loop=l38, preserve_unit_loops=True, index=-1)
  sch.unroll(loop=l24)
  sch.unroll(loop=l22)
  sch.unroll(loop=l19)
  b79 = sch.decompose_reduction(block=b0, loop=l23)
  l80, l81, l82, l83 = sch.get_loops(block=b79)
  sch.unroll(loop=l82)
  sch.unroll(loop=l83)
  l84, l85, l86, l87 = sch.get_loops(block=b1)
  sch.unroll(loop=l86)
  v88, v89 = sch.sample_perfect_tile(loop=l87, n=2, max_innermost_factor=16, decision=[1, 8])
  l90, l91 = sch.split(loop=l87, factors=[v88, v89], preserve_unit_iters=True)
  sch.vectorize(loop=l91)
  sch.annotate(block_or_loop=l24, ann_key="software_pipeline_stage", ann_val=[0, 0, 1])
  sch.annotate(block_or_loop=l24, ann_key="software_pipeline_order", ann_val=[0, 1, 2])
  sch.annotate(block_or_loop=l23, ann_key="software_pipeline_stage", ann_val=[0, 0, 2, 3, 3])
  sch.annotate(block_or_loop=l23, ann_key="software_pipeline_order", ann_val=[0, 1, 3, 2, 4])
  sch.annotate(block_or_loop=l23, ann_key="software_pipeline_async_stages", ann_val=[0, 1])
  sch.enter_postproc()
